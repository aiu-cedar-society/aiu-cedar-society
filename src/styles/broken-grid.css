/**
 * Broken Grid Layout System
 * 2025 Design Trend: Intentional asymmetry and overlap
 * Based on CSS Grid with Subgrid support
 */

/* ================================
   BROKEN GRID - Base Container
   ================================ */

.broken-grid {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: 2rem;
    align-items: start;
    /* Support for intentional overflow */
    overflow: visible;
}

@media (max-width: 767px) {
    .broken-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
}

@media (min-width: 768px) {
    .broken-grid {
        grid-template-columns: repeat(8, 1fr);
        gap: 1.5rem;
    }
}

@media (min-width: 1024px) {
    .broken-grid {
        grid-template-columns: repeat(12, 1fr);
        gap: 2rem;
    }
}

/* ================================
   BROKEN GRID ITEMS - Intentional Offsets
   ================================ */

.broken-grid-item {
    position: relative;
    /* Default: spans 1 column */
    grid-column: span 1;
}

/* Column span variants */
.broken-grid-item[data-col-span="1"] { grid-column: span 1; }
.broken-grid-item[data-col-span="2"] { grid-column: span 2; }
.broken-grid-item[data-col-span="3"] { grid-column: span 3; }
.broken-grid-item[data-col-span="4"] { grid-column: span 4; }
.broken-grid-item[data-col-span="5"] { grid-column: span 5; }
.broken-grid-item[data-col-span="6"] { grid-column: span 6; }
.broken-grid-item[data-col-span="full"] { grid-column: 1 / -1; }

/* Row span variants */
.broken-grid-item[data-row-span="1"] { grid-row: span 1; }
.broken-grid-item[data-row-span="2"] { grid-row: span 2; }
.broken-grid-item[data-row-span="3"] { grid-row: span 3; }

/* Intentional offsets - breaking the grid */
.broken-grid-item[data-offset-x="1"] { 
    transform: translateX(2rem);
    z-index: 1;
}

.broken-grid-item[data-offset-x="2"] { 
    transform: translateX(4rem);
    z-index: 2;
}

.broken-grid-item[data-offset-x="-1"] { 
    transform: translateX(-2rem);
    z-index: 1;
}

.broken-grid-item[data-offset-y="1"] { 
    transform: translateY(2rem);
}

.broken-grid-item[data-offset-y="2"] { 
    transform: translateY(4rem);
}

.broken-grid-item[data-offset-y="-1"] { 
    transform: translateY(-2rem);
}

/* Combined offsets */
.broken-grid-item[data-offset-x="1"][data-offset-y="1"] {
    transform: translate(2rem, 2rem);
}

.broken-grid-item[data-offset-x="-1"][data-offset-y="1"] {
    transform: translate(-2rem, 2rem);
}

/* ================================
   CSS SUBGRID - Perfect Alignment
   ================================ */

/* Subgrid container - defines the grid structure */
.subgrid-container {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    grid-template-rows: auto auto 1fr auto;
    gap: 1rem;
    align-items: start;
}

/* Subgrid items - inherit parent grid */
.subgrid-item {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
    grid-column: span 12;
    /* Perfect alignment even with varying content */
}

@supports not (grid-template-columns: subgrid) {
    /* Fallback for browsers without subgrid support */
    .subgrid-item {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
}

/* Subgrid card structure */
.subgrid-card {
    display: grid;
    grid-template-rows: subgrid;
    grid-row: span 4;
}

.subgrid-card-header {
    grid-row: 1;
}

.subgrid-card-title {
    grid-row: 2;
}

.subgrid-card-content {
    grid-row: 3;
}

.subgrid-card-footer {
    grid-row: 4;
    /* Perfect alignment regardless of content height */
    align-self: end;
}

/* ================================
   OVERLAP EFFECTS - Image & Text
   ================================ */

.overlap-content {
    position: relative;
    z-index: 1;
}

.overlap-image {
    position: relative;
    z-index: 0;
    /* Image can overflow and overlap text */
    margin: -2rem -2rem 2rem -2rem;
}

/* Image behind text */
.overlap-image-behind {
    position: absolute;
    inset: 0;
    z-index: -1;
    opacity: 0.4;
    mix-blend-mode: multiply;
}

/* Text over image */
.overlap-text-overlay {
    position: relative;
    z-index: 10;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    margin-top: -4rem;
    margin-left: 2rem;
}

/* ================================
   BROKEN GRID CARD
   ================================ */

.broken-grid-card {
    position: relative;
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    border: 1px solid rgba(0, 104, 55, 0.1);
    transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
    overflow: visible;
}

.broken-grid-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 104, 55, 0.15);
}

/* Card with image overlap */
.broken-grid-card-image {
    position: absolute;
    top: -2rem;
    right: -2rem;
    width: 40%;
    height: auto;
    border-radius: 0.5rem;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    z-index: 2;
}

/* Card content adjustment for image overlap */
.broken-grid-card.has-image {
    padding-right: calc(40% + 2rem);
}

/* ================================
   RESPONSIVE ADJUSTMENTS
   ================================ */

@media (max-width: 767px) {
    /* Reset offsets on mobile for better UX */
    .broken-grid-item[data-offset-x],
    .broken-grid-item[data-offset-y] {
        transform: none;
    }
    
    .broken-grid-item[data-col-span] {
        grid-column: span 1;
    }
    
    .overlap-image {
        margin: 0 0 1rem 0;
    }
    
    .overlap-text-overlay {
        margin: 0;
        position: static;
    }
    
    .broken-grid-card-image {
        position: static;
        width: 100%;
        margin-bottom: 1rem;
    }
    
    .broken-grid-card.has-image {
        padding-right: 2rem;
    }
}

/* ================================
   ACCESSIBILITY
   ================================ */

@media (prefers-reduced-motion: reduce) {
    .broken-grid-item[data-offset-x],
    .broken-grid-item[data-offset-y] {
        transform: none !important;
    }
    
    .broken-grid-card {
        transition: none;
    }
    
    .broken-grid-card:hover {
        transform: none;
    }
}
